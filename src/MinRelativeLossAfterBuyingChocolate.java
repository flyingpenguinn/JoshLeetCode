import base.ArrayUtils;

import java.util.Arrays;

public class MinRelativeLossAfterBuyingChocolate {
    public long[] minimumRelativeLosses(int[] a, int[][] qs) {
        int n = a.length;
        Arrays.sort(a);
        long[] sum = new long[n];
        for (int i = 0; i < n; ++i) {
            sum[i] = i == 0 ? a[i] : (sum[i - 1] + a[i]);
        }
        long[] res = new long[qs.length];
        for (int i = 0; i < qs.length; ++i) {
            int[] q = qs[i];
            int k = q[0];
            int m = q[1];
            // first >=
            int pos = binaryMid(a, k);
            int l = 0;
            int u = Math.min(m, pos);
            while (l <= u) {
                int mid = l + (u - l) / 2;
                if (mid == 0) {
                    // we are not going to go more left
                    l = mid + 1;
                    continue;
                }
                final long v1 = value(sum, m, k, mid);
                final long v2 = value(sum, m, k, mid - 1);
                if (v1 <= v2) {
                    l = mid + 1;
                } else {
                    u = mid - 1;
                }
            }
            // u is the last mid<=mid-1
            res[i] = value(sum, m, k, u);
        }
        return res;
    }

    private int binaryMid(int[] a, int k) {
        int n = a.length;
        int l = 0;
        int u = n - 1;
        while (l <= u) {
            int mid = l + (u - l) / 2;
            if (a[mid] >= k) {
                u = mid - 1;
            } else {
                l = mid + 1;
            }
        }
        return l;
    }

    private long value(long[] sum, int m, int k, int v) {
        int n = sum.length;
        long sum1 = v <= 0 ? 0 : sum[v - 1];
        int left = m - v;
        long sum2 = 2L * k * left - (sum[n - 1] - (n - 1 - left < 0 ? 0 : sum[n - 1 - left]));
        return sum1 + sum2;
    }

    public static void main(String[] args) {
        System.out.println(Arrays.toString(new MinRelativeLossAfterBuyingChocolate().minimumRelativeLosses(ArrayUtils.read1d("[307904,536005,538037,992650,690493,637325,481936,926678,271403,826919,524417,30988,233039,401957,578297,385355,859333,957642,552088,294351,114099,888145,464812,948646,518988,594637,267467,91743,92553,191746,529458,181044,884684,1811,318592,612074,561073,214588,69033,207538,280791,889968,218887,618589,754536,647237,179680,640454,609369,723924,183721,349441,767421,192289,71200,577154,569204,450381,546076,347526,670521,983063,581594,336047,97831,706739,107160,288564,102465,703072,716846,934541,192201,9101,713781,937657,468146,532033,817516,848952,198210,119143,819729,367380,501232,458710,804046,670431,655036,600833,353864,202448,54419,22420,855014,222073,709183,38492,874756,324369,592837,600007,266725,217697,423189,402323,557735,423394,178787,712348,724346,908305,742385,207423,34576,924954,69650,438666,494453,790808,481464,635128,195745,206105,723328,114979,178293,190131,540647,250920,152932,940238,160382,494530,453469,74743,991121,862356,711439,472601,456373,36281,651794,160336,133087,186702,906674,561322,529328,813570,759455,327735,62761,376810,997654,770879,357183,29510,325916,164686,693077,805855,912152,514886,734642,558118,91159,286343,884911,904820,108099,292166,78970,566382,587684,156712,111977,539567,238493,21444,619660,742272,232764,890086,636017,236235,959070,402364,820908,494967,187494,466985,150136,896411,388759,105419,191025,930666,580121,892219,487290,635657,125851,283048,369182,973728,778686,485079,837612,96703,780618,360477,946143,170042,984437,863485,705402,759289,364153,323781,769633,938248,449738,167798,450577,966510,50858,744597,810279,165204,59881,9979,951929,346871,996178,507918,928081,610242,428656,745974,313130,879791,3631,222637,695319,236560,928273,374909,432778,492009,965684,886933,835660,817369,720750,155198,531270,311866,619178,485358,872876,543105,252487,738855,873510,801029,59863,417027,867487,172630,489843,831201,930212,774724,695796,842744,962716,1438,328811,172287,628032,22688,630900,405830,249734,974378,17148,381678,349988,698529,659719,383031,547498,252154,685245,554966,698990,970157,544863,853053,138652,300186,21866,455477,869573,608163,114149,888406,653483,324507,212950,908170,155569,180097,181077,166390,21924,731387,782236,312165,996505,742285,577469,229061,594480,120945,643751,991126,964195,470100,878640,541256,25600,274903,119474,639011,97109,753449,96107,773931,766888,885979,73939,216252,903007,615991,205757,890531,603066,506058,733343,202779,673544,829196,415682,35505,602268,386332,559519,466393,239226,840165,816199,902994,479987,441433,132537,100175,114071,121016,920454,980846,857293,739162,222356,652990,904214,323774,607337,184294,233575,392315,370247,454543,257727,448338,245309,827081,174467,812717,943234,539908,384324,196473,241399,876932,628704,842900,857056,311019,322441,689753,343772,332934,323464,293505,393564,906174,245541,376524,56247,5883,464516,446576,452217,538682,701498,891826,560105,524176,515080,585155,390972,756333,826197,111485,809710,588686,969093,528125,620460,936547,837258,235400,838950,394237,522362,123917,734904,381809,223713,567843,251519,571227,566269,768180,704489,181585,274366,765250,979342,698571,206772,287917,746988,883708,690326,190038,989151,430584,34254,594723,639639,272180,289843,633421,49098,816862,113698,40633,4967,802392,720854,865279,946108,979839,675498,740880,311962,528981,931315,372051,495786,756333,712841,198451,390808,526590,851634,352139,219396,140240,549710,538260,51874,457975,34886,134084,374518,397988,922554,464714,556922,47788,688313,754342,720187,498101,999028,773831,572751,971441,90534,630147,834014,776230,246218,60469,499601,725597,419538,217850,861344,315029,198362,134965,541781,706374,221989,778668,998705,227532,918198,282028,396042,934960,715808,444241,142469,69017,531963,203267,777061,939377,90505,841334,622100,505221,508667,437890,220364,530307,956128,992239,512379,480797,325054,864340,564202,390198,404556,204919,704527,177486,144358,309653,252818,703620,570050,349307,13206,944735,909482,783434,311252,705596,386330,69395,606512,222199,202235,260090,414453,881312,917077,475262,180049,286022,579539,878003,316981,626702,485008,65910,51893,940424,262443,671023,566138,166613,244029,514111,566125,579308,980640,14445,760419,917162,98028,180201,381304,458185,923900,621665,207714,80026,351102,433672,861101,541215,762884,429306,919744,409895,847674,746719,708325,556372,451978,918407,348976,166501,676166,702869,222425,999534,375318,156263,737605,99072,948576,397040,536451,834695,368466,332089,732560,658487,917119,905782,718204,873236,911102,170189,944829,953159,627503,462131,92657,944416,162181,23652,481530,641668,571278,40644,914385,644572,387940,164647,522528,948091,477475,6102,503101,924366,107909,683262,472198,235998,233307,635776,413746,812667,724191,704200,256447,138118,463745,412735,275574,660726,55783,190749,632500,642559,860740,946560,61858,728697,857502,427032,729216,119003,795206,52667,370641,193180,573772,990993,192869,714108,146070,339863,941,976406,753730,480192,703306,207662,35977,456448,855469,262562,48959,824364,216225,565955,473053,199824,933505,60354,152469,697475,737783,117798,912454,528853,677999,652528,939942,100892,506014,265983,650988,610015,44862,302340,31713,603284,137741,702719,613888,401671,25716,534265,513521,93657,204087,151415,283021,558481,627202,514066,797275,741064,906931,15006,532248,959656,926256,773476,411215,194391,800169,467897,491486,878252,529456,142167,794459,989057,798072,450544,485458,900461,779996,7631,589501,668656,487962,212992,987586,518524,622463,500438,549482,380801,264467,599276,829634,9313,720671,715613,819565,458571,733641,619925,779292,441491,44395,76072,157355,351005,733083,500137,904655,919107,16163,540422,604986,207264,572378,336795,127975,580368,981088,135335,565605,810858,878757,718494,657029,94715,13083,459268,97566,356237,600373,772393,285047,738524,85269,263626,582798,66932,441429,600975,291418,239766,23958,370343,136425,548323,549052,124510,876050,744881,35533,663950,852107,411530,822171,47438,318412,97572,370605,979406,222394,64052,724813,367096,292775,909860,980610,500152,943040,275264,113241,788917,882961,875654,4272,817630,863291,568322,438876,999422,748665,100943,321288,822899,427937,985427,608260,732144,74175,308459,867337,356751,330748,633491,647222,773628,769644,233590,344566,24799,9826,987701,454747,753680,149799,729612,495744,129916,747423,102695,609218,360481,14323,514500,436946,285712,843428,737804,219828,642824,120404,174422,854742,909286,938973,590072,208293,518762,433924,786287,714218,512693,528696,408078,684475,402227,656665,945016,153721,160273,736967,658071,896648,985872,461707,559088,332078,653018,206252,756722,857693,169025,155625,1504,887141,773987,525706,20999,796141,697675,833563,142502,522523,554210,269529,860167,275631,376168,342847,517989,171998,237239,73052,808566,719292,982808,851468,781904,439631,331582,642051,40158,804097,253421,143282,637700,601637,360346,19728,689306,307342,393259]"), ArrayUtils.read("[[195477,493]]"))));
    }
}
