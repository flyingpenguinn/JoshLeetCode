import base.ArrayUtils;

import java.util.*;

public class MinScoreAfterRemoval {
    private Set<Integer>[] g;
    private Set<Integer>[] t;
    private int[] xorm;
    private int res = Integer.MAX_VALUE;

    public int minimumScore(int[] a, int[][] edges) {
        int n = a.length;
        xorm = new int[n];
        g = new HashSet[n];
        t = new HashSet[n];
        for (int i = 0; i < n; ++i) {
            g[i] = new HashSet<>();
            t[i] = new HashSet<>();
        }
        for (int[] e : edges) {
            int v1 = e[0];
            int v2 = e[1];
            g[v1].add(v2);
            g[v2].add(v1);
        }

        for (int[] e : edges) {
            int v1 = e[0];
            int v2 = e[1];
            g[v1].remove(v2);
            g[v2].remove(v1);
            for (int i = 0; i < n; ++i) {
                t[i] = new HashSet<>();
            }
            Arrays.fill(xorm, 0);
            boolean[] seen = new boolean[n];
            dfs(0, a, seen);
            int res3 = 0;
            int resall = 0;
            for (int i = 0; i < n; ++i) {
                if (!seen[i]) {
                    res3 ^= a[i];
                } else {
                    resall ^= a[i];
                }
            }
            //    System.out.println(v1+"-"+v2+" "+resall+" "+res3);
            solve(0, resall, res3);
            g[v1].add(v2);
            g[v2].add(v1);
        }
        return res;
    }

    private int dfs(int i, int[] a, boolean[] seen) {
        seen[i] = true;
        int xor = a[i];
        for (int ne : g[i]) {
            if (!seen[ne]) {
                t[i].add(ne);
                xor ^= dfs(ne, a, seen);
            }
        }
        xorm[i] = xor;
        return xor;
    }

    private void solve(int i, int resall, int res3) {
        if (t[i].isEmpty()) {
            return;
        }
        for (int ne : t[i]) {
            int res1 = xorm[ne];
            int res2 = resall ^ res1;
            int cmax = Math.max(res1, Math.max(res2, res3));
            int cmin = Math.min(res1, Math.min(res2, res3));
            //   System.out.println("looking at "+i+"->"+ne+" "+res2);
            res = Math.min(res, cmax - cmin);
            solve(ne, resall, res3);
        }
    }

    public static void main(String[] args) {
        long start = System.currentTimeMillis();
        System.out.println(new MinScoreAfterRemoval().minimumScore(ArrayUtils.read1d("[14210034,28936672,96812775,88636802,89706244,31354043,48890289,82103474,41474382,34488395,89701422,15498403,59620245,38246012,27258192,10928777,40697458,68602595,1205985,6308081,59671040,16970952,61323462,56199937,14530770,80527210,48264551,73844875,34936090,70134155,16720193,75183966,55598649,56182522,54746007,75875037,21615790,61104739,25494437,74748130,73758944,73083853,45732133,29832003,51025195,68333547,97254724,92278081,53439214,31843254,51738694,55615387,52794741,84549657,13828716,16385348,1672082,7203802,44472204,25306739,30679428,36844447,30044294,72621215,38360353,37606447,86783111,30329964,46667542,39634519,38725372,70567692,24820656,74163887,72490984,65768079,43354503,57491816,61194094,52253444,20183238,66181221,43155148,23909913,91101119,26643242,4817046,52151157,9650729,54222871,33790630,43606320,88849174,43491721,66636042,14198658,96183484,10097965,83019413,21022738,19673271,78301430,15010855,33609408,29485043,51185463,509321,91298222,82612622,76433009,99008932,64290742,57681678,58746770,48789836,98652629,61493612,70545246,55906904,90096840,95504192,86107459,96287847,14391930,78844391,900724,45174887,48720858,40914069,52894154,32849208,19183160,92123738,96404106,28329433,46095335,24808033,10321425,29678135,50669237,12877084,75354139,85983190,1546147,19414019,35413195,91540420,8850310,3069170,69204734,21983148,61868795,51396830,21680716,40613312,81687649,22452182,91283963,15096019,23566570,99559661,87093241,56837747,73735849,64617313,58506487,20146788,22499051,93881187,94605626,20356436,74052458,96553470,80914014,71316099,92725853,89581299,55124098,83278538,9349345,26769586,73328266,37319479,45383737,22347450,97968687,53894543,25524207,92654126,92648431,54063297,92522924,58336488,26022586,51059899,63386891,3172658,40600298,34035989,27112529,10991920,73641846,35843128,55840943,17297828,91687311,82615708,78272050,87447192,87456799,56747076,44037239,23723020,63268451,68961601,22339026,79475080,7177196,35085515,899556,64848911,25582933,13624437,81401929,46262703,50639815,61629591,362807,96574442,42905081,91800130,43698525,92862109,88261348,45626841,58818844,79773182,95661057,3692358,52174146,88047347,54845763,80379449,91442385,74084872,63746538,42678417,41948550,56977876,27792178,74593060,67398323,13693376,44589157,44296212,67396866,88964236,73075643,78666793,67393328,69912095,69432170,79652130,34787333,93768,65232561,73871882,93474703,68049523,73617188,20909873,22277240,60534516,59201965,92021887,65986221,73359435,12389138,67016488,68649799,3308948,12756791,92065285,77353472,46499536,30222259,46916375,9654036,9688431,5391990,37014569,45897085,1373333,19732586,95889725,98649892,70217318,86431610,95235146,10299021,10907045,6486800,25482961,32767410,69365669,564909,28001788,16607195,84710334,4737050,97567368,57480941,57403115,9580556,3870450,936687,59458920,78187525,91398850,14022397,7851985,41998262,25127099,59396264,96522993,84974257,99792230,15677219,4656823,59482589,80308203,60696324,79933086,85144832,72976173,15067620,38632835,59551428,96560222,40142390,29162214,58574476,98183184,64953531,67769283,71871063,91198494,87440241,53180306,42011767,79710828,86237693,37132662,49351193,93838856,94373572,7901085,39363532,30310387,18175383,19889671,96511099,73228494,83036359,67062463,60611437,37764003,41100185,40927024,91607243,98970162,74795056,77577527,91911999,70005446,46860644,1915555,30561395,69617625,74587675,37406798,67881963,35363489,35434908,31126334,69820097,63984730,74417524,50600899,55933456,87922319,81692231,84314681,58807548,58725232,35662275,64925315,25771069,40411886,97143547,79719172,91859212,34004538,54368453,17921160,39355171,98054302,39406753,41213389,8179765,71379888,92524834,50445556,90035388,35114529,58658727,50460840,49090571,4648485,3002795,31277532,87689487,67972714,67789467,23980396,2328570,55877877,74925042,86462147,36617859,43806653,26810658,84257950,7997565,8916716,57397654,71940486,96838075,30709416,50942979,83196214,82626936,60837279,73359760,82672098,37837258,99039482,6925704,64300808,5185619,58339375,79237534,17012859,21680735,10602511,31654372,170369,57461508,76747932,68227311,27188346,75079292,13885431,66992847,55441742,4782672,13171635,95136919,97849768,13375223,17097473,50732535,85216237,11202695,62041610,70270384,81657067,20705146,31384351,45809146,40997637,13264037,4437669,42749245,20307095,46149686,31774794,50164087,71821368,28439470,91179298,16742592,82482627,40422937,47862574,18799167,35972701,82931636,86166486,56953712,60540571,39160076,60631765,22184765,54284082,19256877,8943878,35901676,44793470,37393749,28450376,48244042,56526497,8518838,66879448,42145927,44649521,74605211,63073641,15783462,68714852,23630770,73093430,37380412,9550073,50430621,7421190,34913521,80067147,81499875,69860992,23230532,4878462,7103785,91399939,68529554,16389402,56882418,47596639,4355229,83518129,91912047,28249535,98423535,77470404,81314453,17275290,94597789,66566057,32005979,60634808,65212115,89062174,33084689,9266808,92920370,74366285,59712074,95243265,35606354,53165674,6205124,36226828,49214003,68911981,69017186,58170139,33559656,33088449,94583984,44720569,42106336,65721452,3574476,35937005,2192806,90705847,9447248,84300381,48075072,11092064,37885020,14784445,76453116,93243310,88736066,14832349,4354919,1080020,99424620,3189939,55773865,98015373,48547406,60902812,78543932,17690753,43948091,834982,61218316,92882905,75296653,21773258,79262694,93466856,76894968,29527276,58900587,71794925,67870285,58766707,61074355,74198995,20232433,87649125,29807828,71066944,19866835,23583864,75452088,51959466,44632586,17514596,19138148,47551341,82131893,44484054,37821335,88038868,69689909,23026104,54632898,69553125,88879938,8405470,82657034,58883002,14673039,80492358,69237340,15737149,14137664,29781091,13215429,5913189,55496918,86475554,1816867,76346142,5663451,29891390,12644026,92127619,43396024,93828318,49534091,91146488,71424450,71631708,89211376,71533222,33320820,52082981,55859035,49726713,82930543,70765604,58058721,20557021,52619379,71786796,81413916,91181141,72455446,58494032,66353175,13204823,73781889,29862435,86626862,34899792,77554193,64487299,16993198,35749614,84576901,28037843,75297294,98318503,45257202,41283228,20003551,55061352,38815211,95451101,92958951,66098201,57044213,25647430,40379467,30494937,65220909,72865165,90314734,37476610,56488716,18995152,77866067,50025313,94558749,88613087,44854162,86340648,6458216,70526404,97021848,29208595,37507979,92346840,55784417,64651534,10581333,61054193,19552631,43597123,88106549,81551815,87751894,45893303,67206499,76832126,95348831,97131348,714431,16962771,97483746,38525708,86527492,51368370,36996028,53104140,18638151,74619701,81299501,82988218,90061485,41829746,38051233,56404793,37661952,36751137,32291394,64404330,73844741,97481726,44407992,40537344,69875769,62797499,10738966,56928996,64355622,40041580,190852,88963234,75111581,13175935,92287134,42464996,85559191,32659413,16245274,43054909,61474674,4490185,5560533,65917545,39780489,67884543,33129239,6439097,75970663,62823728,34597955,5380781,21771613,4166103,3784982,75525656,89460459,19881326,32551575,9541438,38567663,85132651,329657,96331895,91528294,25931049,65552537,46122357,64098296,38530321,31113946,60665482,47557239,33097588,96463510,56153797,43621186,19072955,55384518,94284027,44295867,90130482,68233328,73078981,95909750,11152164,35883531,96373049,12248887,66116346,40000696,52052940,61500470,19524397,85981341,95818523,74368300,52319021,25348353,37691834,16748215,91747243,75302573,18505763,23799914,37784011,44007213,50958671,13934231,41563001,11541494,98445012,58924582,98727548,98698830,34769004,939202,54175342,29103001,64072649,39056078,63130813,40687676,47430823,71839940,99550723,60305668,36838709,98795339,33020538,30139497,95855382,46967692,78482564,80347317,4716722,3270464,13286987,99623371,12680084,41142097,95578251,8887205,40687227,42026236,8206600,46106798,49834834,63757560,57470616,83086292,82134408,98440615,82897205,10787496,88837372,15629684,768811,6031264,25708842,41066645,39909133,57363184,77962275,76766760,51843382,1835708,78259724,24965401,8893210,85815822,12748744,6464240,52400016,76427203,57713551,30769235,71135690,45148031,85931836,37217514,67863558,64681740,10931727,76571755,23426971,57397895,59038537,78346492,26246038,58045566,88840032,4083540,76905311,52880023,84534401,96108760,58057563,9057571,83015045,18212225,67347643,23166548,52772912,72978649,48170755,29305666,36078364,66297098,42127520,19126522,42990268,13113225,24148936,83201406,59494294,79331616,47431712,41774778,62260779,78193366,37638033,88051203,74856769,84104531,71551316,2001775,50825893,75340758,26390144,23267405,88721008,89012963,55794444,91022857,59479435,97052069,28053820,48998402,67638069,84578829,13642046,61864114,64552837,5653684,74543491,76282870,1627600,18881693,35455371,23869325,3880658,83624079,60748727,61877577,2675358,15193951,76225162,98163087,54392877,97329588,60776021,63413894,6081181,86758073,84714747,89221690]"), ArrayUtils.read("[[753,445],[228,445],[228,504],[504,601],[975,601],[393,975],[393,863],[863,29],[103,29],[103,241],[241,147],[147,212],[212,385],[385,971],[917,971],[917,390],[201,390],[201,522],[28,522],[392,28],[392,9],[454,9],[454,715],[331,715],[740,331],[740,224],[224,42],[42,690],[791,690],[791,719],[719,498],[498,575],[851,575],[51,851],[444,51],[444,257],[257,591],[969,591],[969,429],[429,828],[50,828],[216,50],[60,216],[580,60],[580,788],[776,788],[980,776],[541,980],[541,426],[657,426],[699,657],[699,693],[693,911],[911,919],[919,602],[602,329],[276,329],[276,455],[455,351],[226,351],[226,312],[312,464],[464,562],[88,562],[88,129],[618,129],[618,561],[561,272],[270,272],[815,270],[703,815],[907,703],[732,907],[732,814],[428,814],[263,428],[871,263],[871,696],[696,622],[622,132],[196,132],[196,511],[511,326],[248,326],[730,248],[772,730],[800,772],[978,800],[256,978],[163,256],[902,163],[441,902],[441,763],[763,404],[954,404],[954,255],[623,255],[829,623],[829,18],[18,621],[621,324],[742,324],[680,742],[680,746],[727,746],[727,827],[714,827],[714,409],[858,409],[858,932],[54,932],[54,410],[410,593],[593,855],[855,232],[416,232],[265,416],[265,679],[166,679],[839,166],[705,839],[422,705],[375,422],[122,375],[122,835],[221,835],[808,221],[420,808],[844,420],[249,844],[111,249],[90,111],[90,573],[573,735],[735,350],[350,780],[780,131],[694,131],[572,694],[572,503],[503,913],[477,913],[367,477],[337,367],[337,989],[894,989],[544,894],[629,544],[118,629],[710,118],[710,550],[550,105],[105,918],[146,918],[604,146],[613,604],[613,254],[254,437],[437,979],[992,979],[311,992],[311,921],[388,921],[388,676],[896,676],[107,896],[107,307],[80,307],[80,2],[2,368],[341,368],[231,341],[200,231],[648,200],[648,175],[916,175],[624,916],[624,282],[282,49],[49,26],[26,485],[485,962],[323,962],[48,323],[48,456],[535,456],[280,535],[280,609],[609,76],[277,76],[287,277],[938,287],[938,663],[379,663],[379,543],[521,543],[521,659],[659,206],[603,206],[603,988],[988,109],[109,382],[726,382],[726,434],[434,378],[120,378],[217,120],[405,217],[235,405],[235,152],[152,78],[78,204],[446,204],[446,964],[642,964],[642,789],[789,547],[547,459],[459,754],[316,754],[935,316],[645,935],[645,73],[73,904],[469,904],[493,469],[493,860],[55,860],[98,55],[98,630],[144,630],[172,144],[21,172],[21,310],[796,310],[842,796],[149,842],[149,336],[244,336],[820,244],[820,915],[291,915],[291,662],[283,662],[497,283],[135,497],[135,394],[394,658],[157,658],[157,610],[610,490],[179,490],[179,451],[451,709],[709,117],[856,117],[425,856],[425,849],[468,849],[468,929],[929,496],[555,496],[555,344],[344,84],[84,809],[866,809],[759,866],[517,759],[442,517],[359,442],[23,359],[976,23],[976,286],[286,465],[707,465],[68,707],[68,925],[925,473],[473,698],[574,698],[619,574],[619,756],[756,373],[373,96],[96,655],[655,396],[396,632],[873,632],[592,873],[592,606],[606,773],[773,476],[546,476],[670,546],[670,169],[169,415],[415,143],[143,721],[721,37],[37,633],[633,823],[823,951],[838,951],[518,838],[234,518],[234,596],[961,596],[953,961],[953,20],[20,450],[450,33],[33,269],[628,269],[377,628],[377,0],[667,0],[227,667],[227,148],[148,64],[64,317],[317,720],[840,720],[840,289],[119,289],[119,353],[353,354],[646,354],[599,646],[599,305],[305,360],[688,360],[799,688],[583,799],[583,567],[567,611],[611,32],[189,32],[294,189],[39,294],[38,39],[371,38],[889,371],[889,993],[993,972],[348,972],[81,348],[81,502],[399,502],[952,399],[571,952],[436,571],[436,453],[164,453],[164,802],[167,802],[449,167],[654,449],[654,597],[597,945],[669,945],[612,669],[612,825],[328,825],[328,66],[66,686],[499,686],[499,653],[981,653],[981,438],[438,431],[685,431],[685,387],[387,852],[58,852],[790,58],[273,790],[334,273],[908,334],[637,908],[579,637],[761,579],[761,345],[112,345],[112,412],[651,412],[651,736],[967,736],[527,967],[467,527],[140,467],[140,27],[27,56],[170,56],[931,170],[931,771],[771,664],[339,664],[339,687],[797,687],[381,797],[381,407],[407,782],[160,782],[899,160],[558,899],[352,558],[352,355],[355,850],[850,85],[85,213],[847,213],[16,847],[16,576],[12,576],[12,529],[824,529],[824,941],[594,941],[540,594],[233,540],[233,298],[57,298],[57,525],[525,514],[514,836],[374,836],[374,222],[222,509],[423,509],[423,526],[526,691],[995,691],[995,194],[194,672],[957,672],[534,957],[463,534],[463,854],[854,183],[151,183],[401,151],[401,461],[364,461],[364,617],[389,617],[389,841],[841,885],[22,885],[22,548],[548,384],[384,300],[300,757],[193,757],[427,193],[195,427],[741,195],[937,741],[240,937],[240,91],[7,91],[7,124],[487,124],[487,268],[268,247],[247,779],[484,779],[985,484],[660,985],[660,923],[923,903],[903,230],[695,230],[695,843],[843,198],[198,447],[447,296],[306,296],[898,306],[139,898],[211,139],[211,987],[86,987],[86,874],[587,874],[587,192],[267,192],[59,267],[460,59],[460,810],[810,113],[113,909],[865,909],[309,865],[330,309],[154,330],[318,154],[536,318],[806,536],[806,846],[846,245],[153,245],[570,153],[472,570],[53,472],[53,480],[480,542],[133,542],[395,133],[892,395],[892,649],[552,649],[94,552],[203,94],[203,928],[568,928],[568,302],[302,668],[668,421],[877,421],[832,877],[996,832],[996,876],[876,115],[998,115],[822,998],[822,508],[734,508],[734,905],[362,905],[362,643],[36,643],[36,868],[252,868],[142,252],[615,142],[478,615],[812,478],[910,812],[290,910],[440,290],[440,308],[457,308],[45,457],[684,45],[684,93],[93,769],[608,769],[608,912],[977,912],[977,914],[914,414],[983,414],[983,801],[106,801],[106,207],[207,598],[598,539],[539,327],[186,327],[239,186],[239,138],[607,138],[607,631],[229,631],[229,262],[262,417],[13,417],[13,861],[861,215],[697,215],[697,322],[30,322],[176,30],[786,176],[17,786],[17,946],[946,448],[728,448],[882,728],[882,357],[749,357],[777,749],[777,635],[635,74],[74,922],[750,922],[774,750],[116,774],[19,116],[19,586],[692,586],[973,692],[990,973],[243,990],[930,243],[347,930],[347,982],[982,712],[960,712],[738,960],[738,332],[332,202],[202,432],[432,940],[100,940],[100,8],[8,955],[955,128],[867,128],[867,162],[162,483],[501,483],[970,501],[970,386],[859,386],[462,859],[495,462],[926,495],[197,926],[869,197],[869,520],[804,520],[67,804],[67,590],[590,14],[798,14],[798,182],[870,182],[870,906],[906,372],[214,372],[214,626],[626,639],[639,303],[303,4],[250,4],[250,537],[102,537],[102,673],[673,137],[319,137],[319,984],[114,984],[114,433],[433,97],[708,97],[708,458],[500,458],[370,500],[947,370],[947,439],[258,439],[711,258],[816,711],[47,816],[47,89],[89,559],[563,559],[563,553],[553,997],[785,997],[253,785],[807,253],[807,783],[783,636],[722,636],[722,755],[755,585],[585,551],[551,933],[620,933],[620,181],[181,288],[288,944],[177,944],[177,279],[581,279],[581,875],[897,875],[897,65],[155,65],[155,261],[261,75],[70,75],[70,805],[110,805],[110,887],[71,887],[5,71],[943,5],[943,391],[391,781],[275,781],[275,986],[986,304],[304,219],[994,219],[489,994],[489,418],[418,614],[491,614],[491,482],[271,482],[271,419],[963,419],[470,963],[470,516],[650,516],[650,616],[616,879],[185,879],[185,238],[848,238],[744,848],[505,744],[505,488],[739,488],[297,739],[158,297],[729,158],[40,729],[888,40],[880,888],[880,365],[365,745],[745,223],[223,292],[292,713],[361,713],[125,361],[174,125],[82,174],[554,82],[549,554],[549,506],[506,784],[795,784],[891,795],[35,891],[35,264],[264,363],[363,150],[242,150],[383,242],[901,383],[857,901],[474,857],[474,578],[883,578],[883,958],[524,958],[524,701],[398,701],[398,411],[411,92],[301,92],[718,301],[718,72],[682,72],[349,682],[349,924],[924,479],[479,314],[314,845],[845,528],[528,11],[752,11],[343,752],[343,156],[156,299],[803,299],[803,136],[3,136],[145,3],[826,145],[640,826],[872,640],[173,872],[173,974],[717,974],[717,83],[83,884],[884,751],[751,627],[627,325],[325,507],[340,507],[63,340],[818,63],[369,818],[369,545],[545,165],[625,165],[625,531],[205,531],[209,205],[210,209],[46,210],[104,46],[218,104],[220,218],[220,743],[743,770],[939,770],[939,237],[108,237],[584,108],[584,589],[595,589],[656,595],[656,724],[724,376],[376,733],[208,733],[968,208],[968,513],[513,178],[178,600],[600,758],[408,758],[408,677],[677,862],[862,475],[41,475],[1,41],[853,1],[747,853],[225,747],[225,515],[813,515],[813,171],[171,560],[10,560],[10,315],[748,315],[794,748],[878,794],[991,878],[530,991],[530,260],[260,25],[130,25],[494,130],[999,494],[87,999],[949,87],[834,949],[191,834],[191,837],[837,564],[564,582],[582,44],[44,652],[934,652],[681,934],[259,681],[259,731],[731,95],[236,95],[320,236],[320,400],[400,647],[647,671],[335,671],[335,413],[557,413],[557,683],[737,683],[356,737],[356,24],[24,523],[523,199],[199,187],[556,187],[965,556],[62,965],[62,284],[284,605],[605,890],[890,956],[956,121],[121,702],[787,702],[775,787],[927,775],[278,927],[342,278],[266,342],[443,266],[443,766],[766,77],[77,674],[321,674],[321,6],[6,538],[538,430],[638,430],[638,762],[762,481],[481,127],[127,406],[406,920],[134,920],[134,52],[942,52],[942,723],[723,704],[704,69],[69,403],[403,190],[190,246],[246,31],[31,936],[936,15],[886,15],[886,634],[634,700],[285,700],[285,959],[168,959],[486,168],[486,689],[689,533],[641,533],[141,641],[532,141],[43,532],[43,424],[833,424],[833,366],[366,492],[101,492],[435,101],[435,251],[123,251],[881,123],[512,881],[512,792],[830,792],[830,725],[725,510],[661,510],[661,811],[180,811],[180,666],[765,666],[893,765],[402,893],[402,452],[565,452],[895,565],[397,895],[397,665],[665,34],[768,34],[519,768],[313,519],[778,313],[948,778],[948,760],[293,760],[764,293],[764,675],[819,675],[644,819],[950,644],[950,706],[706,678],[678,577],[577,380],[338,380],[338,188],[333,188],[333,159],[159,831],[831,161],[161,900],[900,793],[793,821],[821,274],[274,566],[566,184],[184,99],[864,99],[767,864],[767,61],[295,61],[346,295],[346,569],[79,569],[358,79],[588,358],[588,471],[716,471],[716,281],[817,281],[817,466],[126,466],[966,126]]")));
        long end = System.currentTimeMillis();
        System.out.println("time..." + (end - start));
    }
}
